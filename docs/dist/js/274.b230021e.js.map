{"version":3,"file":"js/274.b230021e.js","mappings":"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","sources":["webpack://question-star/./src/views/user/loginOrRegister/components/cardBox.vue?93a9","webpack://question-star/./src/views/user/loginOrRegister/components/cardBox.vue","webpack://question-star/./src/utils/FormRules.ts","webpack://question-star/./src/hook/useGenVeriCode.ts","webpack://question-star/./src/views/user/loginOrRegister/phoneLogin.vue?bde4","webpack://question-star/./src/views/user/loginOrRegister/phoneLogin.vue","webpack://question-star/./src/views/user/loginOrRegister/phoneLogin.vue?9bd1"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { renderSlot as _renderSlot, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = (n: any) => (_pushScopeId(\"data-v-19529e4a\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"card-box\" }\nconst _hoisted_2 = { class: \"card-form\" }\nconst _hoisted_3 = { class: \"card-title\" }\n\nimport { } from 'vue'\r\n\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'cardBox',\n  setup(__props) {\n\r\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", _hoisted_3, [\n        _renderSlot(_ctx.$slots, \"title\")\n      ]),\n      _renderSlot(_ctx.$slots, \"form\")\n    ])\n  ]))\n}\n}\n\n})","import script from \"./cardBox.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./cardBox.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./cardBox.vue?vue&type=style&index=0&id=19529e4a&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.4.38_vue@3.4.38_webpack@5.91.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-19529e4a\"]])\n\nexport default __exports__","import type { Rule } from 'ant-design-vue/es/form'\r\n\r\nexport const PhoneRules: Rule[] = [\r\n    { required: true, message: '请输入手机号', trigger: 'blur' },\r\n    {\r\n        pattern: /^1[3-9]\\d{9}$/,\r\n        message: '请输入合法的11位手机号',\r\n        trigger: 'blur'\r\n    }\r\n]\r\n","import { ref, watch } from 'vue'\r\n\r\n// 获取验证码时，倒计时功能\r\nexport default function useGenVeriCode() {\r\n    const timeNumber = ref(60000)\r\n    const timeSwitch = ref(false)\r\n\r\n    watch(timeSwitch, (val) => {\r\n        if (val) {\r\n            setInterval(() => {\r\n                if (timeNumber.value === 0) {\r\n                    timeSwitch.value = false\r\n                    timeNumber.value = 60000\r\n                }\r\n                timeNumber.value = timeNumber.value - 1000\r\n            }, 1000)\r\n        }\r\n    })\r\n    return {\r\n        timeNumber,\r\n        timeSwitch\r\n    }\r\n}\r\n","import { defineComponent as _defineComponent } from 'vue'\nimport { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, unref as _unref, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = { key: 0 }\nconst _hoisted_2 = { key: 1 }\n\nimport cardBox from './components/cardBox.vue'\r\nimport type { Rule, FormInstance } from 'ant-design-vue/es/form'\r\nimport { reactive, ref } from 'vue'\r\nimport { PhoneRules } from '@/utils/FormRules'\r\nimport { PhoneLoginParams } from '@/type/api/user'\r\nimport { reqGetVeriCode } from '@/api/user/index'\r\nimport { message } from 'ant-design-vue'\r\nimport useGenVeriCode from '@/hook/useGenVeriCode'\r\nimport { useStore } from '@/store/index'\r\nimport { useRoute, useRouter } from 'vue-router'\r\n\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'phoneLogin',\n  setup(__props) {\n\r\nconst $route = useRoute()\r\nconst $router = useRouter()\r\nconst $store = useStore()\r\nconst rules: Record<string, Rule[]> = {\r\n    phoneNumber: PhoneRules,\r\n    veriCode: [\r\n        { required: true, message: '请输入四位验证码', trigger: 'change' },\r\n        { len: 4, message: '验证码长度为四位数字', trigger: 'change' }\r\n    ]\r\n}\r\n\r\nconst formRef = ref<FormInstance>()\r\nconst formData = reactive<PhoneLoginParams>({\r\n    phoneNumber: '15975228030',\r\n    veriCode: ''\r\n})\r\n\r\nconst { timeNumber, timeSwitch } = useGenVeriCode()\r\n\r\nconst submitForm = () => {\r\n    formRef.value!.validate().then(async () => {\r\n        // 将数据都带给仓库请求\r\n        $store.dispatch('userStore/phoneLogin', formData).then(() => {\r\n            setTimeout(() => {\r\n                $router.push($route.query.redirect ? $route.query.redirect as string : '/')\r\n            }, 2000)\r\n        }).catch((error) => {\r\n            console.log(error)\r\n        })\r\n    }).catch(() => {\r\n        console.log('校验不通过')\r\n    }\r\n    )\r\n}\r\n\r\nconst genVeriCode = () => {\r\n    formRef.value?.validateFields('phoneNumber').then(async () => {\r\n        try {\r\n            await reqGetVeriCode(formData.phoneNumber)\r\n            message.success('发送验证码成功，请注意查收!')\r\n            timeSwitch.value = true\r\n        } catch (error) {\r\n        }\r\n    }).catch(() => {\r\n        message.error('请先输入正确的手机号')\r\n    })\r\n}\r\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_a_input = _resolveComponent(\"a-input\")!\n  const _component_a_form_item = _resolveComponent(\"a-form-item\")!\n  const _component_a_button = _resolveComponent(\"a-button\")!\n  const _component_a_form = _resolveComponent(\"a-form\")!\n\n  return (_openBlock(), _createBlock(cardBox, null, {\n    title: _withCtx(() => [\n      _createTextVNode(\"手机号登录\")\n    ]),\n    form: _withCtx(() => [\n      _createVNode(_component_a_form, {\n        ref_key: \"formRef\",\n        ref: formRef,\n        model: formData,\n        \"label-col\": { span: 8 },\n        \"wrapper-col\": { span: 16 },\n        rules: rules,\n        autocomplete: \"off\"\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_a_form_item, {\n            label: \"手机号\",\n            name: \"phoneNumber\"\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_input, {\n                value: formData.phoneNumber,\n                \"onUpdate:value\": _cache[0] || (_cache[0] = ($event: any) => ((formData.phoneNumber) = $event))\n              }, null, 8, [\"value\"])\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_a_form_item, {\n            label: \"验证码\",\n            name: \"veriCode\"\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_input, {\n                value: formData.veriCode,\n                \"onUpdate:value\": _cache[1] || (_cache[1] = ($event: any) => ((formData.veriCode) = $event))\n              }, null, 8, [\"value\"])\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_a_form_item, { \"wrapper-col\": { offset: 8, span: 16 } }, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_button, {\n                type: \"primary\",\n                onClick: submitForm\n              }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"登录\")\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_button, {\n                style: {\"margin-left\":\"10px\"},\n                onClick: genVeriCode,\n                disabled: _unref(timeSwitch)\n              }, {\n                default: _withCtx(() => [\n                  (!_unref(timeSwitch))\n                    ? (_openBlock(), _createElementBlock(\"span\", _hoisted_1, \" 获取验证码 \"))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_2, \" 倒计时\" + _toDisplayString(Math.round(_unref(timeNumber) / 1000)) + \"s \", 1))\n                ]),\n                _: 1\n              }, 8, [\"disabled\"])\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }, 8, [\"model\"])\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","<template>\r\n    <cardBox>\r\n        <template v-slot:title>手机号登录</template>\r\n        <template v-slot:form>\r\n            <a-form ref=\"formRef\" :model=\"formData\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 16 }\" :rules=\"rules\"\r\n                autocomplete=\"off\">\r\n                <a-form-item label=\"手机号\" name=\"phoneNumber\">\r\n                    <a-input v-model:value=\"formData.phoneNumber\" />\r\n                </a-form-item>\r\n\r\n                <a-form-item label=\"验证码\" name=\"veriCode\">\r\n                    <a-input v-model:value=\"formData.veriCode\" />\r\n                </a-form-item>\r\n\r\n                <a-form-item :wrapper-col=\"{ offset: 8, span: 16 }\">\r\n                    <a-button type=\"primary\" @click=\"submitForm\">登录</a-button>\r\n                    <a-button style=\"margin-left: 10px\" @click=\"genVeriCode\" :disabled=\"timeSwitch\">\r\n                        <span v-if=\"!timeSwitch\">\r\n                            获取验证码\r\n                        </span>\r\n                        <div v-else>\r\n                            倒计时{{ Math.round(timeNumber / 1000) }}s\r\n                        </div>\r\n                    </a-button>\r\n                </a-form-item>\r\n            </a-form>\r\n        </template>\r\n    </cardBox>\r\n</template>\r\n\r\n<script setup lang='ts'>\r\nimport cardBox from './components/cardBox.vue'\r\nimport type { Rule, FormInstance } from 'ant-design-vue/es/form'\r\nimport { reactive, ref } from 'vue'\r\nimport { PhoneRules } from '@/utils/FormRules'\r\nimport { PhoneLoginParams } from '@/type/api/user'\r\nimport { reqGetVeriCode } from '@/api/user/index'\r\nimport { message } from 'ant-design-vue'\r\nimport useGenVeriCode from '@/hook/useGenVeriCode'\r\nimport { useStore } from '@/store/index'\r\nimport { useRoute, useRouter } from 'vue-router'\r\n\r\nconst $route = useRoute()\r\nconst $router = useRouter()\r\nconst $store = useStore()\r\nconst rules: Record<string, Rule[]> = {\r\n    phoneNumber: PhoneRules,\r\n    veriCode: [\r\n        { required: true, message: '请输入四位验证码', trigger: 'change' },\r\n        { len: 4, message: '验证码长度为四位数字', trigger: 'change' }\r\n    ]\r\n}\r\n\r\nconst formRef = ref<FormInstance>()\r\nconst formData = reactive<PhoneLoginParams>({\r\n    phoneNumber: '15975228030',\r\n    veriCode: ''\r\n})\r\n\r\nconst { timeNumber, timeSwitch } = useGenVeriCode()\r\n\r\nconst submitForm = () => {\r\n    formRef.value!.validate().then(async () => {\r\n        // 将数据都带给仓库请求\r\n        $store.dispatch('userStore/phoneLogin', formData).then(() => {\r\n            setTimeout(() => {\r\n                $router.push($route.query.redirect ? $route.query.redirect as string : '/')\r\n            }, 2000)\r\n        }).catch((error) => {\r\n            console.log(error)\r\n        })\r\n    }).catch(() => {\r\n        console.log('校验不通过')\r\n    }\r\n    )\r\n}\r\n\r\nconst genVeriCode = () => {\r\n    formRef.value?.validateFields('phoneNumber').then(async () => {\r\n        try {\r\n            await reqGetVeriCode(formData.phoneNumber)\r\n            message.success('发送验证码成功，请注意查收!')\r\n            timeSwitch.value = true\r\n        } catch (error) {\r\n        }\r\n    }).catch(() => {\r\n        message.error('请先输入正确的手机号')\r\n    })\r\n}\r\n</script>\r\n\r\n<style scoped lang='scss'></style>\r\n","import script from \"./phoneLogin.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./phoneLogin.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","_defineComponent","__name","setup","__props","_ctx","_cache","_openBlock","_createElementBlock","_createElementVNode","_renderSlot","$slots","__exports__","PhoneRules","required","message","trigger","pattern","useGenVeriCode","timeNumber","ref","timeSwitch","watch","val","setInterval","value","key","$route","useRoute","$router","useRouter","$store","useStore","rules","phoneNumber","veriCode","len","formRef","formData","reactive","submitForm","validate","then","async","dispatch","setTimeout","push","query","redirect","catch","error","console","log","genVeriCode","validateFields","reqGetVeriCode","success","_component_a_input","_resolveComponent","_component_a_form_item","_component_a_button","_component_a_form","_createBlock","cardBox","title","_withCtx","_createTextVNode","form","_createVNode","ref_key","model","span","autocomplete","default","label","name","$event","_","offset","type","onClick","style","disabled","_unref","_toDisplayString","Math","round"],"sourceRoot":""}