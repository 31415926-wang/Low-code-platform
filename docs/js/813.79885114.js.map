{"version":3,"file":"js/813.79885114.js","mappings":"uPAYA,GAA4BA,EAAAA,EAAAA,IAAiB,CAC3CC,OAAQ,QACRC,KAAAA,CAAMC,GCUR,MAAMC,GAASC,EAAAA,EAAAA,MACTC,GAAWC,EAAAA,EAAAA,MACXC,GAAeD,EAAAA,EAAAA,MAEfE,EAAyBC,IACpBC,EAAAA,EAAAA,GAAKD,EAAiBE,EAAAA,IAG3BC,EAAcC,UAChB,MAAMC,QAAeC,EAAAA,EAAAA,IAAcC,OAAOb,EAAOc,OAAOC,KACxDb,EAASc,MAAQL,EAAOM,KAAKC,QAE7Bd,EAAaY,MAAQG,SAASjB,EAASc,OAAOI,MAAMC,MAAgB,EAIlEC,GAAYC,EAAAA,EAAAA,KAAS,KACvB,MAAM,MAAEH,GAAUlB,EAASc,MACrBQ,EAAYC,EAAUL,GAE5B,MAAO,IACAI,EACH,mBAAoBA,EAAU,oBACxB,OAAOA,EAAU,uBACjB,GAEK,IAIbC,EAAaC,IACf,IAAK,MAAMC,KAAOD,EACd,GAA6B,kBAAlBA,EAASC,IAAqBD,EAASC,GAAKC,SAAS,OAA8C,IAArCF,EAASC,GAAKE,MAAM,MAAMC,OAAc,CAE7G,MAAMC,EAAc3B,EAAaY,MAC3BgB,GAAanB,OAAOa,EAASC,GAAKM,QAAQ,KAAM,KAAOF,EAAe,KAAKG,QAAQ,GAAK,KAC9FR,EAASC,GAAOK,C,CAGxB,OAAON,CAAQ,EDDnB,OCIAS,EAAAA,EAAAA,KAAU,KACN1B,GAAa,IDLV,CAAC2B,EAAUC,IACRnC,EAASc,QACZsB,EAAAA,EAAAA,OAAcC,EAAAA,EAAAA,IAAoB,MAAO,CACxCZ,IAAK,EACLa,MAAO,YACPC,OAAOC,EAAAA,EAAAA,IAAgBpB,EAAUN,QAChC,GACAsB,EAAAA,EAAAA,KAAW,IAAOC,EAAAA,EAAAA,IAAoBI,EAAAA,GAAW,MAAMC,EAAAA,EAAAA,IAAY1C,EAASc,OAAO6B,YAAY,CAACC,EAAMC,MAC7FT,EAAAA,EAAAA,OAAcC,EAAAA,EAAAA,IAAoB,MAAO,CAC/CZ,IAAKmB,EAAK/B,GACV0B,OAAOC,EAAAA,EAAAA,IAAgB,IAAKrC,EAAsBoB,EAAUqB,EAAK1B,QAAS,UAAW2B,KACpF,GACAT,EAAAA,EAAAA,OAAcU,EAAAA,EAAAA,KAAaC,EAAAA,EAAAA,IAAyBH,EAAKI,OAAOC,EAAAA,EAAAA,IAAY,CAAEC,SAAS,GAAQ,IAAK3B,EAAUqB,EAAK1B,OAAQiC,YAAaP,EAAKQ,OAAS,CACrJvC,GAAI+B,EAAK/B,KACP,KAAM,GAAI,CAAC,SACd,MACD,OACH,KACHwC,EAAAA,EAAAA,IAAoB,IAAI,EAE9B,I,WE3EA,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://question-star/./src/views/lego-works/previewWork/index.vue?7dc2","webpack://question-star/./src/views/lego-works/previewWork/index.vue","webpack://question-star/./src/views/lego-works/previewWork/index.vue?86f1"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveDynamicComponent as _resolveDynamicComponent, mergeProps as _mergeProps, createBlock as _createBlock, normalizeStyle as _normalizeStyle, createCommentVNode as _createCommentVNode } from \"vue\"\n\nimport { useRoute } from 'vue-router'\r\nimport { onMounted, ref, computed, StyleValue } from 'vue'\r\nimport { reqDetailWork } from '@/api/works/workItem'\r\nimport { ContextData } from '@/type/api/work'\r\nimport type { AllWidgetProps } from 'question-star-bricks'\r\nimport { parentWrapperStyleKeys } from 'question-star-bricks'\r\nimport { pick } from 'lodash-es'\r\n\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\r\nconst $route = useRoute()\r\nconst workData = ref<ContextData>()\r\nconst defaultWidth = ref()\r\n\r\nconst getParentWrapperStyle = (widgetsOwnProps: Partial<AllWidgetProps>) => {\r\n    return pick(widgetsOwnProps, parentWrapperStyleKeys) as any\r\n}\r\n\r\nconst getWorkDate = async () => {\r\n    const result = await reqDetailWork(Number($route.params.id))\r\n    workData.value = result.data.content\r\n    // 存储默认宽度\r\n    defaultWidth.value = parseInt(workData.value?.props.width as string)\r\n}\r\n\r\n// 页面属性\r\nconst pageStyle = computed(() => {\r\n    const { props } = workData.value!\r\n    const propsTemp = processPx(props)\r\n\r\n    return {\r\n        ...propsTemp,\r\n        'background-image': propsTemp['background-image']\r\n            ? `url(${propsTemp['background-image']})`\r\n            : ''\r\n        // 修复url(undefined)的请求404问题\r\n    } as StyleValue\r\n})\r\n\r\n// 加工成vw单位\r\nconst processPx = (styleObj: object) => {\r\n    for (const key in styleObj) {\r\n        if (typeof styleObj[key] === 'string' && styleObj[key].includes('px') && styleObj[key].split('px').length === 2) {\r\n            // 找出比例\r\n            const designWidth = defaultWidth.value\r\n            const newValue = ((Number(styleObj[key].replace('px', '')) / designWidth) * 100).toFixed(2) + 'vw'\r\n            styleObj[key] = newValue\r\n        }\r\n    }\r\n    return styleObj\r\n}\r\n\r\nonMounted(() => {\r\n    getWorkDate()\r\n})\r\n\nreturn (_ctx: any,_cache: any) => {\n  return (workData.value)\n    ? (_openBlock(), _createElementBlock(\"div\", {\n        key: 0,\n        class: \"container\",\n        style: _normalizeStyle(pageStyle.value)\n      }, [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(workData.value?.components, (item, index) => {\n          return (_openBlock(), _createElementBlock(\"div\", {\n            key: item.id,\n            style: _normalizeStyle({ ...getParentWrapperStyle(processPx(item.props)), 'z-index': index })\n          }, [\n            (_openBlock(), _createBlock(_resolveDynamicComponent(item.name), _mergeProps({ ref_for: true }, { ...processPx(item.props), widgetTitle: item.title }, {\n              id: item.id\n            }), null, 16, [\"id\"]))\n          ], 4))\n        }), 128))\n      ], 4))\n    : _createCommentVNode(\"\", true)\n}\n}\n\n})","<template>\r\n    <div class=\"container\" v-if=\"workData\" :style=\"pageStyle\">\r\n        <div v-for=\"(item, index) in workData?.components\" :key=\"item.id\"\r\n            :style=\"{ ...getParentWrapperStyle(processPx(item.props)), 'z-index': index }\">\r\n            <component :is=\"item.name\" v-bind=\"{ ...processPx(item.props), widgetTitle: item.title }\" :id=\"item.id\">\r\n            </component>\r\n        </div>\r\n\r\n    </div>\r\n    <!-- <div class=\"box\">我会是vw单位</div> -->\r\n    <!-- <pre>\r\n         {{ workData?.components }}\r\n        </pre> -->\r\n</template>\r\n\r\n<script setup lang='ts'>\r\nimport { useRoute } from 'vue-router'\r\nimport { onMounted, ref, computed, StyleValue } from 'vue'\r\nimport { reqDetailWork } from '@/api/works/workItem'\r\nimport { ContextData } from '@/type/api/work'\r\nimport type { AllWidgetProps } from 'question-star-bricks'\r\nimport { parentWrapperStyleKeys } from 'question-star-bricks'\r\nimport { pick } from 'lodash-es'\r\n\r\nconst $route = useRoute()\r\nconst workData = ref<ContextData>()\r\nconst defaultWidth = ref()\r\n\r\nconst getParentWrapperStyle = (widgetsOwnProps: Partial<AllWidgetProps>) => {\r\n    return pick(widgetsOwnProps, parentWrapperStyleKeys) as any\r\n}\r\n\r\nconst getWorkDate = async () => {\r\n    const result = await reqDetailWork(Number($route.params.id))\r\n    workData.value = result.data.content\r\n    // 存储默认宽度\r\n    defaultWidth.value = parseInt(workData.value?.props.width as string)\r\n}\r\n\r\n// 页面属性\r\nconst pageStyle = computed(() => {\r\n    const { props } = workData.value!\r\n    const propsTemp = processPx(props)\r\n\r\n    return {\r\n        ...propsTemp,\r\n        'background-image': propsTemp['background-image']\r\n            ? `url(${propsTemp['background-image']})`\r\n            : ''\r\n        // 修复url(undefined)的请求404问题\r\n    } as StyleValue\r\n})\r\n\r\n// 加工成vw单位\r\nconst processPx = (styleObj: object) => {\r\n    for (const key in styleObj) {\r\n        if (typeof styleObj[key] === 'string' && styleObj[key].includes('px') && styleObj[key].split('px').length === 2) {\r\n            // 找出比例\r\n            const designWidth = defaultWidth.value\r\n            const newValue = ((Number(styleObj[key].replace('px', '')) / designWidth) * 100).toFixed(2) + 'vw'\r\n            styleObj[key] = newValue\r\n        }\r\n    }\r\n    return styleObj\r\n}\r\n\r\nonMounted(() => {\r\n    getWorkDate()\r\n})\r\n</script>\r\n\r\n<style>\r\nhtml,\r\nbody,\r\n#app {\r\n    height: auto !important;\r\n}\r\n</style>\r\n<style scoped lang='scss'>\r\n.container {\r\n    position: relative;\r\n    background-size: cover;\r\n}\r\n\r\n.box {\r\n    border: 1px solid red;\r\n    width: 300px;\r\n    height: 667px;\r\n}\r\n</style>\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=64341b64&lang=css\"\nimport \"./index.vue?vue&type=style&index=1&id=64341b64&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.4.38_vue@3.4.38_webpack@5.91.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-64341b64\"]])\n\nexport default __exports__"],"names":["_defineComponent","__name","setup","__props","$route","useRoute","workData","ref","defaultWidth","getParentWrapperStyle","widgetsOwnProps","pick","parentWrapperStyleKeys","getWorkDate","async","result","reqDetailWork","Number","params","id","value","data","content","parseInt","props","width","pageStyle","computed","propsTemp","processPx","styleObj","key","includes","split","length","designWidth","newValue","replace","toFixed","onMounted","_ctx","_cache","_openBlock","_createElementBlock","class","style","_normalizeStyle","_Fragment","_renderList","components","item","index","_createBlock","_resolveDynamicComponent","name","_mergeProps","ref_for","widgetTitle","title","_createCommentVNode","__exports__"],"sourceRoot":""}